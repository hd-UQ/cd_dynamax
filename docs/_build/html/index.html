
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Welcome to DYNAMAX! &#8212; dynamax documentation</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="HMM with 2d Gaussian emissions" href="notebooks/hmm/gaussian_hmm_2d..html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="#">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.gif" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contents:
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/hmm/gaussian_hmm_2d..html">
   HMM with 2d Gaussian emissions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks/linear_gaussian_ssm/kf_tracking..html">
   Tracking a 2d point moving in the plane using the Kalman filter
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  API Documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ssm.html">
   SSM
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/index.rst.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.rst</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Welcome to DYNAMAX!
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#installation-and-testing">
     Installation and Testing
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-are-state-space-models">
     What are state space models?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inference">
     Inference
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#learning-model-fitting">
     Learning (model fitting)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#related-libraries">
     Related Libraries
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notebooks">
   Notebooks
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#api-documentation">
   API documentation
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#indices-and-tables">
   Indices and tables
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Welcome to DYNAMAX!</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Welcome to DYNAMAX!
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#installation-and-testing">
     Installation and Testing
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-are-state-space-models">
     What are state space models?
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inference">
     Inference
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#learning-model-fitting">
     Learning (model fitting)
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#related-libraries">
     Related Libraries
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notebooks">
   Notebooks
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#api-documentation">
   API documentation
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#indices-and-tables">
   Indices and tables
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="welcome-to-dynamax">
<h1>Welcome to DYNAMAX!<a class="headerlink" href="#welcome-to-dynamax" title="Permalink to this headline">¶</a></h1>
<p>Dynamax is a library for probabilistic state space models (SSMs) written in <a class="reference external" href="https://github.com/google/jax">JAX</a>.
It has code for inference (state estimation) and learning (parameter estimation)
in a variety of SSMs, including:</p>
<ul class="simple">
<li><p>Hidden Markov Models (HMMs)</p></li>
<li><p>Autoregressive Hidden Markov Models (AR-HMMs)</p></li>
<li><p>Linear Gaussian State Space Models (aka Linear Dynamical Systems)</p></li>
<li><p>Nonlinear Gaussian State Space Models</p></li>
</ul>
<p>The library consists of a set of core, functionally pure, low-level inference algorithms,
as well as a set of model classes which provide a more user-friendly, object-oriented interface.
It is compatible with other libraries in the JAX ecosystem,
such as <a class="reference external" href="https://github.com/deepmind/optax">optax</a> (useful for estimating parameters using stochastic gradient descent),
and <a class="reference external" href="https://github.com/blackjax-devs/blackjax">Blackjax</a> (useful for computing the posterior using Hamiltonian Monte Carlo (HMC)
or sequential Monte Carlo (SMC)).</p>
<div class="section" id="installation-and-testing">
<h2>Installation and Testing<a class="headerlink" href="#installation-and-testing" title="Permalink to this headline">¶</a></h2>
<p>To install locally, do this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">git clone git@github.com:probml/dynamax.git</span>
<span class="go">cd dynamax</span>
<span class="go">pip install -e .</span>
</pre></div>
</div>
<p>To install in Colab, do this:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">%pip install git+https://github.com/probml/dynamax.git</span>
</pre></div>
</div>
<p>To run the tests, do this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">pytest dynamax                         # Run all tests</span>
<span class="go">pytest dynamax/hmm/inference_test.py   # Run a specific test</span>
<span class="go">pytest -k lgssm                        # Run tests with lgssm in the name</span>
</pre></div>
</div>
</div>
<div class="section" id="what-are-state-space-models">
<h2>What are state space models?<a class="headerlink" href="#what-are-state-space-models" title="Permalink to this headline">¶</a></h2>
<p># <a class="reference external" href="https://sphinx-rtd-trial.readthedocs.io/en/latest/ext/math.html">https://sphinx-rtd-trial.readthedocs.io/en/latest/ext/math.html</a></p>
<p>A state space model or SSM is a partially observed Markov model, in which the hidden state,
<span class="math notranslate nohighlight">\(z_t\)</span>, evolves over time according to a Markov process,
possibly conditional on external inputs / controls / covariates,
<span class="math notranslate nohighlight">\(u_t\)</span>,
and generates an observation,
<span class="math notranslate nohighlight">\(y_t\)</span>.
This is illustrated in the graphical model below.</p>
<div class="figure align-default">
<a class="reference internal image-reference" href="_images/LDS-UZY.png"><img alt="SSM as a graphical model." src="_images/LDS-UZY.png" style="width: 378.0px; height: 392.0px;" /></a>
</div>
<p>The corresponding joint distribution has the following form
(in dynamax, we restrict attention to discrete time systems):
.. math:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="p">(</span><span class="n">y_</span><span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="n">T</span><span class="p">},</span> <span class="n">z_</span><span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="n">T</span><span class="p">}</span> <span class="o">|</span> <span class="n">u_</span><span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="n">T</span><span class="p">})</span> <span class="o">=</span>
 <span class="n">p</span><span class="p">(</span><span class="n">z_1</span> <span class="o">|</span> <span class="n">u_1</span><span class="p">)</span> <span class="n">p</span><span class="p">(</span><span class="n">y_1</span> <span class="o">|</span> <span class="n">z_1</span><span class="p">,</span> <span class="n">u_1</span><span class="p">)</span>
 \<span class="n">prod_</span><span class="p">{</span><span class="n">t</span><span class="o">=</span><span class="mi">1</span><span class="p">}</span><span class="o">^</span><span class="n">T</span> <span class="n">p</span><span class="p">(</span><span class="n">z_t</span> <span class="o">|</span> <span class="n">z_</span><span class="p">{</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">},</span> <span class="n">u_t</span><span class="p">)</span> <span class="n">p</span><span class="p">(</span><span class="n">y_t</span> <span class="o">|</span> <span class="n">z_t</span><span class="p">,</span> <span class="n">u_t</span><span class="p">)</span>
</pre></div>
</div>
<p>Here <span class="math notranslate nohighlight">\(p(z_t | z_{t-1}, u_t)\)</span> is called the transition or dynamics model,
and <span class="math notranslate nohighlight">\(p(y_t | z_{t}, u_t)\)</span> is called the observation or emission model.
(In both cases, the inputs <span class="math notranslate nohighlight">\(u_t\)</span> are optional;
furthermore, the observation model may have auto-regressive dependencies,
in which case we write  <span class="math notranslate nohighlight">\(p(y_t | z_{t}, u_t, y_{1:t-1})\)</span>.)</p>
<p>We assume that we see the observations <span class="math notranslate nohighlight">\(y_{1:T}\)</span>,
and want to infer the hidden states, either
using online filtering (i.e., computing  <span class="math notranslate nohighlight">\(p(z_t|y_{1:t})\)</span>)
or offline smoothing (i.e., computing  <span class="math notranslate nohighlight">\(p(z_t|y_{1:T})\)</span>).
We may also be interested in predicting future states,
<span class="math notranslate nohighlight">\(p(z_{t+h}|y_{1:t})\)</span>,
or future observations,
<span class="math notranslate nohighlight">\(p(y_{t+h}|y_{1:t})\)</span>,
where h is the forecast horizon.
(Note that by using a hidden state  to represent the past observations,</p>
<blockquote>
<div><p>the model can have “infinite” memory, unlike a standard auto-regressive model.)</p>
</div></blockquote>
<p>All of these computations can be done efficiently using our library,
as we discuss below.</p>
</div>
<div class="section" id="inference">
<h2>Inference<a class="headerlink" href="#inference" title="Permalink to this headline">¶</a></h2>
<p>The core inference algorithms, like the forward-backward algorithm for HMMs,
the Kalman filter and smoother for LGSSMs, and the extended and unscented
Kalman filters for nonlinear SSMs, all have a simple, functional interface.
For example, the following code generates some noisy data and then smooths it
with an LGSSM smoother (aka Kalman smoother).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">jax</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">grad</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
<span class="kn">import</span> <span class="nn">jax.random</span> <span class="k">as</span> <span class="nn">jr</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">dynamax.linear_gaussian_ssm.inference</span> <span class="kn">import</span> <span class="n">LGSSMParams</span><span class="p">,</span> <span class="n">lgssm_smoother</span>

<span class="n">key</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">state_dim</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">emission_dim</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_timesteps</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Make some noisy data</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_timesteps</span><span class="p">)</span>
<span class="n">emissions</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">times</span> <span class="o">/</span> <span class="mi">20</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
<span class="n">emissions</span> <span class="o">+=</span> <span class="n">jr</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">(</span><span class="n">num_timesteps</span><span class="p">,</span> <span class="n">emission_dim</span><span class="p">))</span>

<span class="c1"># Specify the model parameters</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">LGSSMParams</span><span class="p">(</span>
   <span class="n">initial_mean</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">state_dim</span><span class="p">),</span>
   <span class="n">initial_covariance</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">state_dim</span><span class="p">),</span>
   <span class="n">dynamics_matrix</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">state_dim</span><span class="p">),</span>
   <span class="n">dynamics_covariance</span><span class="o">=</span><span class="mf">0.5</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">state_dim</span><span class="p">),</span>
   <span class="n">emission_matrix</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">emission_dim</span><span class="p">,</span> <span class="n">state_dim</span><span class="p">)),</span>
   <span class="n">emission_covariance</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">emission_dim</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Run the LGSSM smoother (aka Kalman smoother)</span>
<span class="n">lgssm_posterior</span> <span class="o">=</span> <span class="n">lgssm_smoother</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">emissions</span><span class="p">)</span>
</pre></div>
</div>
<p>The posterior is a dataclass with a number of fields, including the posterior mean and posterior marginal covariances.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lgssm_posterior</span><span class="o">.</span><span class="n">smoothed_means</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>        <span class="c1"># (100, 1)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lgssm_posterior</span><span class="o">.</span><span class="n">smoothed_covariances</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># (100, 1, 1)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lgssm_posterior</span><span class="o">.</span><span class="n">marginal_loglik</span><span class="p">)</span>             <span class="c1"># -160.31303</span>
</pre></div>
</div>
<p>The inference algorithms are all written in JAX, so they support automatic
differentiation and just-in-time compilation,</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">loss</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">params</span><span class="p">:</span> <span class="o">-</span><span class="n">lgssm_smoother</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">emissions</span><span class="p">)</span><span class="o">.</span><span class="n">marginal_loglik</span>
<span class="n">jit</span><span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="n">loss</span><span class="p">))(</span><span class="n">params</span><span class="p">)</span> <span class="c1"># Returns an LGSSMParams dataclass with the gradients in it</span>
</pre></div>
</div>
</div>
<div class="section" id="learning-model-fitting">
<h2>Learning (model fitting)<a class="headerlink" href="#learning-model-fitting" title="Permalink to this headline">¶</a></h2>
<p>Dynamax also includes a host of model classes for various HMMs and linear Gaussian SSMs.
You can use these models to simulate data, and you can fit the models using standard
learning algorithms like expectation-maximization (EM) and stochastic gradient descent (SGD).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>
<span class="kn">import</span> <span class="nn">jax.random</span> <span class="k">as</span> <span class="nn">jr</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">dynamax.hmm.models</span> <span class="kn">import</span> <span class="n">GaussianHMM</span>

<span class="n">key1</span><span class="p">,</span> <span class="n">key2</span><span class="p">,</span> <span class="n">key3</span> <span class="o">=</span> <span class="n">jr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">jr</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">num_states</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">emission_dim</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">num_timesteps</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Make a Gaussian HMM and sample data from it</span>
<span class="n">true_hmm</span> <span class="o">=</span> <span class="n">GaussianHMM</span><span class="p">(</span><span class="n">num_states</span><span class="p">,</span> <span class="n">emission_dim</span><span class="p">)</span>
<span class="n">true_params</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">true_hmm</span><span class="o">.</span><span class="n">random_initialization</span><span class="p">(</span><span class="n">key1</span><span class="p">)</span>
<span class="n">true_states</span><span class="p">,</span> <span class="n">emissions</span> <span class="o">=</span> <span class="n">true_hmm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">true_params</span><span class="p">,</span> <span class="n">key2</span><span class="p">,</span> <span class="n">num_timesteps</span><span class="p">)</span>

<span class="c1"># Make a new Gaussian HMM and fit it with EM</span>
<span class="n">test_hmm</span> <span class="o">=</span> <span class="n">GaussianHMM</span><span class="p">(</span><span class="n">num_states</span><span class="p">,</span> <span class="n">emission_dim</span><span class="p">)</span>
<span class="n">test_params</span><span class="p">,</span> <span class="n">props</span> <span class="o">=</span> <span class="n">test_hmm</span><span class="o">.</span><span class="n">random_initialization</span><span class="p">(</span><span class="n">key3</span><span class="p">)</span>
<span class="n">test_params</span><span class="p">,</span> <span class="n">lls</span> <span class="o">=</span> <span class="n">test_hmm</span><span class="o">.</span><span class="n">fit_em</span><span class="p">(</span><span class="n">test_params</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="n">emissions</span><span class="p">)</span>

<span class="c1"># Plot the marginal log probs across EM iterations</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lls</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;EM iterations&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;marginal log prob.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="related-libraries">
<h2>Related Libraries<a class="headerlink" href="#related-libraries" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/deepmind/distrax/blob/master/distrax/_src/utils/hmm.py">distrax_hmm</a>: JAX functions for HMM inference (replaced by dynamax)</p></li>
<li><p><a class="reference external" href="https://github.com/rlabbe/Kalman-and-Bayesian-Filters-in-Python">filterpy</a>: Numpy library for (extended) Kalman filtering</p></li>
<li><p><a class="reference external" href="https://github.com/hmmlearn/hmmlearn">hmmlearn</a>: Numpy / C++ library for HMMs</p></li>
<li><p><a class="reference external" href="https://github.com/lindermanlab/ssm-jax">linderman-ssm-jax</a>:  JAX library for SSMs (replaced by dynamax)</p></li>
<li><p><a class="reference external" href="https://github.com/lindermanlab/ssm">linderman-ssm-numpy</a>:  Numpy / numba / autograd library for SSMs  (replaced by dynamax)</p></li>
<li><p><a class="reference external" href="https://github.com/mattjj/pyhsmm">mattjj-pyhsmm</a>:  Numpy / Cython library library for HMMs</p></li>
<li><p><a class="reference external" href="https://github.com/mattjj/pylds">mattjj-pylds</a>:  Numpy / Cython library library for linear dynamical systems</p></li>
<li><p><a class="reference external" href="https://github.com/probml/pgm-jax">pgm-jax</a>: JAX library for factor graphs</p></li>
<li><p><a class="reference external" href="https://github.com/probml/JSL">JSL</a>: JAX library for SSMs (replaced by dynamax)</p></li>
<li><p><a class="reference external" href="https://pykalman.github.io/">pykalman</a>: Numpy library for (extended) Kalman filtering</p></li>
<li><p><a class="reference external" href="https://github.com/EEA-sensors/parallel-non-linear-gaussian-smoothers">sarkka-parallel-non-linear-gaussian-smoothers</a>: JAX code for nonlinear smoothers using parallel scan</p></li>
<li><p><a class="reference external" href="https://www.tensorflow.org/probability/api_docs/python/tfp/distributions/HiddenMarkovModel">tfp_hmm</a>: TF2 code for HMM inference</p></li>
<li><p><a class="reference external" href="https://www.tensorflow.org/probability/api_docs/python/tfp/distributions/LinearGaussianStateSpaceModel">tfp_lgssm</a>: TF2 code for Kalman filtering</p></li>
</ul>
</div>
</div>
<div class="section" id="notebooks">
<h1>Notebooks<a class="headerlink" href="#notebooks" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notebooks/hmm/gaussian_hmm_2d..html">HMM with 2d Gaussian emissions</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/linear_gaussian_ssm/kf_tracking..html">Tracking a 2d point moving in the plane using the Kalman filter</a></li>
</ul>
</div>
</div>
<div class="section" id="api-documentation">
<h1>API documentation<a class="headerlink" href="#api-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ssm.html">SSM</a><ul>
<li class="toctree-l2"><a class="reference internal" href="ssm.html#id1">SSM</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='right-next' id="next-link" href="notebooks/hmm/gaussian_hmm_2d..html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">HMM with 2d Gaussian emissions</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Peter Chang, Giles Harper-Donnelly, Aleyna Kara, Xinglong Li, Scott Linderman, and Kevin Murphy<br/>
    
        &copy; Copyright 2022, Peter Chang, Giles Harper-Donnelly, Aleyna Kara, Xinglong Li, Scott Linderman, and Kevin Murphy.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>